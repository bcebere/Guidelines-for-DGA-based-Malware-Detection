# stdlib
import os
from pathlib import Path

# dga_analysis absolute
from dga_analysis.utils.features.data import load_public_suffix_list

__all__ = [
    "LRU_CACHE_SIZE",
    "PUBLIC_SUFFIX_LIST_SOURCE",
    "TLD_LIST_SOURCE",
    "VALID_SUFFIXES",
    "VALID_TLDS",
]

_SETTINGS_FILE_ROOT = Path(os.path.abspath(__file__)).parent

PUBLIC_SUFFIX_LIST_SOURCE = os.getenv(
    "PUBLIC_SUFFIX_LIST_SOURCE",
    _SETTINGS_FILE_ROOT / "utils/data/public_suffix_list.dat",
)
TLD_LIST_SOURCE = os.getenv(
    "TLD_LIST_SOURCE", _SETTINGS_FILE_ROOT / "utils/data/tld.dat"
)

LRU_CACHE_SIZE = int(os.getenv("LRU_CACHE_SIZE", 136))

VALID_SUFFIXES = load_public_suffix_list(
    PUBLIC_SUFFIX_LIST_SOURCE, comments=["!", "//"]
)

# IANA uses a similar style as https://publicsuffix.org/ (c.f. https://data.iana.org/TLD/tlds-alpha-by-domain.txt)
VALID_TLDS = load_public_suffix_list(TLD_LIST_SOURCE, comments=["#"])
