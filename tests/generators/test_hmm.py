# dga_analysis absolute
from dga_analysis.datasets.dataset_tranco import DatasetTranco
from dga_analysis.generators.hmm import HMMGenerator as plugin
from dga_analysis.utils.evaluation import generator_metrics, evaluate_generator


def test_hmm_sanity():
    generator = plugin()
    assert generator.name() == "hmm"


def test_hmm_fit():
    X, _ = DatasetTranco(sample_size=100).raw()
    plugin().fit(X)


def test_hmm_generate():
    X, _ = DatasetTranco(sample_size=100).raw()
    generator = plugin().fit(X)

    samples = generator.generate(10)

    print(samples)

    assert len(samples) == 10


def test_hmm_metrics():
    X, _ = DatasetTranco(sample_size=1000).raw()

    score = evaluate_generator(plugin(), X, 2000, 50)

    print(score)
