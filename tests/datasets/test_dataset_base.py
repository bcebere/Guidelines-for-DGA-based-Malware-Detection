from dga_analysis.datasets.dataset_alexa import DatasetAlexa


def test_drop_duplicates():
    samples = ["a", "a", "b", "c"]
    labels = [0, 0, 1, 1]

    # any dataset
    dataset = DatasetAlexa(sample_size=4, shuffle=False)

    (dedup_samples, dedup_labels) = dataset._drop_duplicates(samples, labels)

    assert len(dedup_samples) == 3
    assert len(dedup_labels) == 3

    zipped = list(zip(dedup_samples, dedup_labels))
    zipped.sort()
    assert zipped[0] == ("a", 0)
    assert zipped[1] == ("b", 1)
    assert zipped[2] == ("c", 1)
