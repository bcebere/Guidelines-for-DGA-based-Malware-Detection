# third party
import numpy as np

# dga_analysis absolute
from dga_analysis.datasets.dataset_cisco import DatasetCisco
from dga_analysis.utils.features.examples import ALL


def test_sanity():
    dataset = DatasetCisco(sample_size=100)

    raw_data, raw_labels = dataset.raw(only_2ld=False)
    assert len(raw_data) == 100
    assert len(raw_labels) == 100
    assert (np.asarray(raw_labels) == 0).all()

    stats_2d, labels = dataset.as_statistical(only_2ld=False)
    assert len(stats_2d.columns) == len(ALL)
    assert len(stats_2d) == len(raw_data)
    assert len(stats_2d) == len(labels)

    for col in stats_2d.columns:
        if stats_2d[col].isna().sum() == 0:
            continue
        print(col, stats_2d[col].values)
